
Page({
    data: {
        schoolData: [
            {
              "title": "清华大学"
            },
            {
              "title": "北京大学"
            },
            {
              "title": "浙江大学"
            },
            {
              "title": "上海交通大学"
            },
            {
              "title": "复旦大学"
            },
            {
              "title": "南京大学"
            },
            {
              "title": "武汉大学"
            },
            {
              "title": "中山大学"
            },
            {
              "title": "中国科学技术大学"
            },
            {
              "title": "西安交通大学"
            },
            {
              "title": "华中科技大学"
            },
            {
              "title": "吉林大学"
            },
            {
              "title": "四川大学"
            },
            {
              "title": "哈尔滨工业大学"
            },
            {
              "title": "南开大学"
            },
            {
              "title": "山东大学"
            },
            {
              "title": "北京师范大学"
            },
            {
              "title": "天津大学"
            },
            {
              "title": "中南大学"
            },
            {
              "title": "东南大学"
            },
            {
              "title": "中国人民大学"
            },
            {
              "title": "北京航空航天大学"
            },
            {
              "title": "厦门大学"
            },
            {
              "title": "大连理工大学"
            },
            {
              "title": "同济大学"
            },
            {
              "title": "华南理工大学"
            },
            {
              "title": "重庆大学"
            },
            {
              "title": "兰州大学"
            },
            {
              "title": "西北工业大学"
            },
            {
              "title": "华东师范大学"
            },
            {
              "title": "北京科技大学"
            },
            {
              "title": "中国农业大学"
            },
            {
              "title": "湖南大学"
            },
            {
              "title": "东北大学"
            },
            {
              "title": "郑州大学"
            },
            {
              "title": "南京航空航天大学"
            },
            {
              "title": "华东理工大学"
            },
            {
              "title": "苏州大学"
            },
            {
              "title": "南京农业大学"
            },
            {
              "title": "武汉理工大学"
            },
            {
              "title": "上海大学"
            },
            {
              "title": "北京科技大学"
            },
            {
              "title": "电子科技大学"
            },
            {
              "title": "西南大学"
            },
            {
              "title": "东北师范大学"
            },
            {
              "title": "西安电子科技大学"
            },
            {
              "title": "西北农林科技大学"
            },
            {
              "title": "暨南大学"
            },
            {
              "title": "南京理工大学"
            },
            {
              "title": "华中师范大学"
            },
            {
              "title": "西南交通大学"
            },
            {
              "title": "中国矿业大学"
            },
            {
              "title": "南京师范大学"
            },
            {
              "title": "扬州大学"
            },
            {
              "title": "华中农业大学"
            },
            {
              "title": "西北大学"
            },
            {
              "title": "中国海洋大学"
            },
            {
              "title": "湖南师范大学"
            },
            {
              "title": "北京交通大学"
            },
            {
              "title": "华南师范大学"
            },
            {
              "title": "北京化工大学"
            },
            {
              "title": "陕西师范大学"
            },
            {
              "title": "南昌大学"
            },
            {
              "title": "山西大学"
            },
            {
              "title": "河海大学"
            },
            {
              "title": "北京科技大学"
            },
            {
              "title": "华南农业大学"
            },
            {
              "title": "江南大学"
            },
            {
              "title": "东华大学"
            },
            {
              "title": "南京工业大学"
            },
            {
              "title": "福州大学"
            },
            {
              "title": "中国地质大学"
            },
            {
              "title": "燕山大学"
            },
            {
              "title": "河南大学"
            },
            {
              "title": "浙江工业大学"
            },
            {
              "title": "哈尔滨工程大学"
            },
            {
              "title": "河北大学"
            },
            {
              "title": "江苏大学"
            },
            {
              "title": "山东农业大学"
            },
            {
              "title": "合肥工业大学"
            },
            {
              "title": "湘潭大学"
            },
            {
              "title": "首都医科大学"
            },
            {
              "title": "云南大学"
            },
            {
              "title": "中南财经政法大学"
            },
            {
              "title": "中国医科大学"
            },
            {
              "title": "南方医科大学"
            },
            {
              "title": "中国地质大学"
            },
            {
              "title": "华北电力大学"
            },
            {
              "title": "上海财经大学"
            },
            {
              "title": "北京邮电大学"
            },
            {
              "title": "中国药科大学"
            },
            {
              "title": "山东师范大学"
            },
            {
              "title": "黑龙江大学"
            },
            {
              "title": "首都师范大学"
            },
            {
              "title": "上海师范大学"
            },
            {
              "title": "安徽大学"
            },
            {
              "title": "福建师范大学"
            },
            {
              "title": "太原理工大学"
            },
            {
              "title": "昆明理工大学"
            }
        ],
        majorData: [
            '哲学',
            '计算机科学与技术',
            '软件工程',
            '网络工程',
            '信息安全',
            '物联网工程',
            '数字媒体技术',
            '土木工程',
            '建筑环境与能源应用工程',
            '给排水科学与工程',
            '建筑电气与智能化',
            '水利水电工程',
            '水文与水资源工程',
            '港口航道与海岸工程',
            '测绘工程',
            '遥感科学与技术',
            '采矿工程',
            '石油工程',
            '矿物加工工程',
            '油气储运工程',
            '轻化工程',
            '包装工程',
            '印刷工程',
            '交通运输',
            '交通工程',
            '航海技术',
            '轮机工程',
            '飞行技术',
            '农业工程',
            '农业机械化及其自动化',
            '农业电气化',
            '农业建筑环境与能源工程',
            '农业水利工程',
            '农学',
            '园艺',
            '植物保护',
            '植物科学与技术',
            '种子科学与工程'
        ],
        randomSchool: {},
        randomMajor: ''
    },
    onLoad(query) {
        /**
         * 满分600分
         * 学校分为6等 500-600|400-500|300-400|200-300|100-200|0-100
         * 
         */
        const { score = 0 } = query;
        const majorLen = this.data.majorData.length;
        const randomMajor = this.data.majorData[Math.floor((Math.random() * majorLen))];
        let index;
        if (score == 600) {
            index = 0;
        } else if (score < 600 && score > 500) {
            index = this.randomNum(0, 10);
        } else if (score <= 500 && score > 400) {
            index = this.randomNum(11, 30);
        } else if (score <= 400 && score > 300) {
            index = this.randomNum(31, 50);
        } else if (score <= 300 && score > 200) {
            index = this.randomNum(51, 70);
        } else if (score <= 200 && score > 100) {
            index = this.randomNum(71, 85);
        } else {
            index = this.randomNum(61, 98);
        }
        const randomSchool = this.data.schoolData[index];
        this.setData({ randomSchool, randomMajor });
        const time = new Date();
        const dataJson = wx.getStorageSync('score_history');
        let data = [];
        try {
            data = JSON.parse(dataJson) || [];
        } catch (e) {
            data = [];
        }
        data.push({ school: randomSchool, major: randomMajor, score, time: `${time.getFullYear()}-${time.getMonth()+1}-${time.getDate()}` });
        wx.setStorageSync('score_history',JSON.stringify(data));
    },
    randomNum(minNum,maxNum){ 
        switch(arguments.length){ 
            case 1: 
                return parseInt(Math.random()*minNum+1,10); 
            case 2: 
                return parseInt(Math.random()*(maxNum-minNum+1)+minNum,10); 
            default: 
                return 0; 
        } 
    } 
})